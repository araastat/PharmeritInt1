---
title       : Intermediate R
subtitle    : Part I Prequel
author      : Abhijit Dasgupta
job         : ARAASTAT
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
widgets     : []            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
--- .segue .dark

## Warmup exercises

---

## Air Quality

1. Using the dataset `airquality`, create a data.frame giving the 
average, minimum and maximum monthly temperature and ozone level
2. Using the same dataset, create plots of daily temperature and ozone levels for each month
3. Create a panel of plots (in a single window) showing the daily temperature pattern by month
4. Create plot(s) showing how ozone relates to wind, temperature and solar radiation

For details about the dataset, try `?airquality`.

For hints, press `p`

*** pnotes

```{r ex1, eval=FALSE}
data(airquality)
library(plyr)
library(ggplot2)
ddply(airquality, ~Month, summarise, ...)
aq5 <- subset(airquality, Month==5)
plot(Ozone~Day, data=aq5)

ggplot(airquality, aes(x=Day, y=Ozone))+geom_point()+facet_wrap(~Month)

pairs(airquality[,c('Ozone','Wind','Temp')])

```

---

## Air Quality

The R function `lm` stands for **linear model** and does linear regression.

Recall that we can write regressions like formulas:
```
lm(y ~ x1 + x2 + x3, data=dat)
```

1. Fit a linear regression model to see how ozone level relates to temperature, wind speed and solar radiation levels, making sure you store the result in an object (say `model1`).
2. Use `summary(model1)` to see the results. Store this in an object
3. Use the object created above to compute 95% confidence intervals for each coefficient
  - Use the function `names` to see components of the object
  - Use matrix extraction rules to extract appropriate columns


Hints on pressing `p`

*** pnotes

```{r eval=FALSE}
model1 <- lm(Ozone~Temp + Wind, data=airquality)
summ1 <- summary(model1)
names(summ1)
summ1$coef
is.data.frame(summ1$coef)

```

---

## Air quality

You can write functions in R to encapsulate repeatable tasks. The general format for functions is
``` 
functionName <- function(arg1, arg2,){
  # Code to be evaluated
}
```

+ Write a function that takes as input the result of a linear regression and the confidence level and outputs a data.frame with each row consisting of a coefficient estimate and the confidence interval
  - If the confidence level is `1-alpha`, you can get the appropriate standard normal quantile using `qnorm(1-alpha)`

Hints on pressing `p`.

*** pnotes

```{r ex2, eval=FALSE}

conf.int <- function(mod, conf.level=0.95){
  summ <- summary(mod)
  q.alpha <- qnorm(conf.level)
  output <- data.frame(Estimate = summ[,1], LCB = summ[,1] - 
                         q.alpha*summ[,2])
  return(output)
}
```
--- .segue .dark






